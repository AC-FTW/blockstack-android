<!DOCTYPE html>
<html>
<head>
<title>Blockstack Sign In</title>
<script src="blockstack.js"></script>
<script>
var host = 'https://flamboyant-darwin-d11c17.netlify.com'
var appDomain = host
var redirectURI = host + '/redirect'
var manifestURI = host + '/manifest.json'

var transitPrivateKey = blockstack.generateAndStoreTransitKey()

var scopes = [ 'store_write' ]

function redirectToSignIn(appDomain, redirectURI, manifestURI, scopes) {
  var authRequest = blockstack.makeAuthRequest(transitPrivateKey, redirectURI, manifestURI, scopes, appDomain)
  blockstack.redirectToSignInWithAuthRequest(authRequest)
}

function handlePendingSignIn(authResponseToken) {
  blockstack.handlePendingSignIn(authResponseToken)
  .then(function(userData) {
    var userDataString = JSON.stringify(userData)
    android.signInSuccess(userDataString)
  })
}

function getFile(path, optionsString, uniqueIdentifier) {
  var options = JSON.stringify(optionsString)
  console.log('getFile: ' + uniqueIdentifier)
  blockstack.getFile(path, options)
  .then(function(result) {
    console.log(result)
    android.getFileResult(result, uniqueIdentifier)
  })
}

function putFile(path, content, optionsString, uniqueIdentifier) {
  var options = JSON.stringify(optionsString)
  console.log('putFile: ' + uniqueIdentifier)
  blockstack.putFile(path, content, options)
  .then(function(result) {
    console.log(result)
    android.putFileResult(result, uniqueIdentifier)
  })
}
</script>
</head>
<body>
<p>Blockstack Sign In</p>
</body>
</html>
